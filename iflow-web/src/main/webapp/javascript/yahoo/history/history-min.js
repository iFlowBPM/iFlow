YAHOO.util.History=function(){function t(){var t,e,n=[],i=[];for(t in u)YAHOO.lang.hasOwnProperty(u,t)&&(e=u[t],n.push(t+"="+e.initialState),i.push(t+"="+e.currentState));o.value=n.join("&")+"|"+i.join("&"),YAHOO.env.ua.webkit&&(o.value+="|"+l.join(","))}function e(t){var e,n;e='<html><body><div id="state">'+t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+"</div></body></html>";try{return n=r.contentWindow.document,n.open(),n.write(e),n.close(),!0}catch(i){return!1}}function n(){var t,e,i;return r.contentWindow&&r.contentWindow.document?(t=r.contentWindow.document,e=t.getElementById("state"),i=e?e.innerText:null,a=!0,void YAHOO.util.History.onLoadEvent.fire()):void setTimeout(n,10)}function i(){var e,i,r,s,d,f,c,g,p,h,O;if(r=o.value.split("|"),r.length>1){for(c=r[0].split("&"),e=0,i=c.length;i>e;e++)s=c[e].split("="),2===s.length&&(d=s[0],g=s[1],f=u[d],f&&(f.initialState=g));for(p=r[1].split("&"),e=0,i=p.length;i>e;e++)s=p[e].split("="),s.length>=2&&(d=s[0],h=s[1],f=u[d],f&&(f.currentState=h))}r.length>2&&(l=r[2].split(",")),YAHOO.env.ua.ie?"undefined"==typeof document.documentMode||document.documentMode<8?n():(YAHOO.util.Event.on(top,"hashchange",function(){t()}),a=!0,YAHOO.util.History.onLoadEvent.fire()):(O=history.length,a=!0,YAHOO.util.History.onLoadEvent.fire())}var r=null,o=null,a=!1,u=[],l=[];return{onLoadEvent:new YAHOO.util.CustomEvent("onLoad"),onReady:function(t,e,n){a?setTimeout(function(){var i=window;n&&(i=n===!0?e:n),t.call(i,"onLoad",[],e)},0):YAHOO.util.History.onLoadEvent.subscribe(t,e,n)},register:function(t,e,n,i,r){var o,l;if("string"!=typeof t||""===YAHOO.lang.trim(t)||"string"!=typeof e||"function"!=typeof n)throw new Error("Missing or invalid argument");if(!u[t]){if(a)throw new Error("All modules must be registered before calling YAHOO.util.History.initialize");t=escape(t),e=escape(e),o=null,o=r===!0?i:r,l=function(t){return n.call(o,t,i)},u[t]={name:t,initialState:e,currentState:e,onStateChange:l}}},initialize:function(t,e){if(!a){if(YAHOO.env.ua.opera&&"undefined"!=typeof history.navigationMode&&(history.navigationMode="compatible"),"string"==typeof t&&(t=document.getElementById(t)),!t||"TEXTAREA"!==t.tagName.toUpperCase()&&("INPUT"!==t.tagName.toUpperCase()||"hidden"!==t.type&&"text"!==t.type))throw new Error("Missing or invalid argument");if(o=t,YAHOO.env.ua.ie&&("undefined"==typeof document.documentMode||document.documentMode<8)){if("string"==typeof e&&(e=document.getElementById(e)),!e||"IFRAME"!==e.tagName.toUpperCase())throw new Error("Missing or invalid argument");r=e}YAHOO.util.Event.onDOMReady(i)}},navigate:function(t,e){var n;if("string"!=typeof t||"string"!=typeof e)throw new Error("Missing or invalid argument");return n={},n[t]=e,YAHOO.util.History.multiNavigate(n)},multiNavigate:function(n){var i,r,o,s,d;if("object"!=typeof n)throw new Error("Missing or invalid argument");if(!a)throw new Error("The Browser History Manager is not initialized");for(r in n)if(!u[r])throw new Error("The following module has not been registered: "+r);i=[];for(r in u)YAHOO.lang.hasOwnProperty(u,r)&&(o=u[r],s=YAHOO.lang.hasOwnProperty(n,r)?n[unescape(r)]:unescape(o.currentState),r=escape(r),s=escape(s),i.push(r+"="+s));return d=i.join("&"),YAHOO.env.ua.ie&&("undefined"==typeof document.documentMode||document.documentMode<8)?e(d):(top.location.hash=d,YAHOO.env.ua.webkit&&(l[history.length]=d,t()),!0)},getCurrentState:function(t){var e;if("string"!=typeof t)throw new Error("Missing or invalid argument");if(!a)throw new Error("The Browser History Manager is not initialized");if(e=u[t],!e)throw new Error("No such registered module: "+t);return unescape(e.currentState)},getBookmarkedState:function(t){var e,n,i,r,o,a,u;if("string"!=typeof t)throw new Error("Missing or invalid argument");if(i=top.location.href.indexOf("#"),i>=0)for(r=top.location.href.substr(i+1),o=r.split("&"),e=0,n=o.length;n>e;e++)if(a=o[e].split("="),2===a.length&&(u=a[0],u===t))return unescape(a[1]);return null},getQueryStringParameter:function(t,e){var n,i,r,o,a,u;for(e=e||top.location.href,r=e.indexOf("?"),o=r>=0?e.substr(r+1):e,r=o.lastIndexOf("#"),o=r>=0?o.substr(0,r):o,a=o.split("&"),n=0,i=a.length;i>n;n++)if(u=a[n].split("="),u.length>=2&&u[0]===t)return unescape(u[1]);return null}}}(),YAHOO.register("history",YAHOO.util.History,{version:"2.8.1pr1r2",build:"9"});